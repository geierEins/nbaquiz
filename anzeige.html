<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <title>Anzeigeeinheit</title>
  <style>
    body { font-family: sans-serif; text-align: center; background: #222; color: #fff; }
    table { border-collapse: separate; border-spacing: 0; border-radius: 20px; overflow: hidden; margin: 30px auto; font-size: 48px; }
    td, th { border: 1px solid #333; width: 200px; height: 90px; text-align: center; padding: 10px; font-weight: bold; }
    th { background: #131313; color: #e6ea6b; font-size: 28px; }
    .scoreboard { display: flex; justify-content: center; gap: 40px; margin-top: 20px; }
    .player-box { background: #333; padding: 20px 30px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.6); min-width: 180px; text-align: center; transition: transform 0.2s; }
    .player-box:hover { transform: scale(1.05); }
    #p1-box { background: #512e74; }
    #p2-box { background: #9c1f1f; }
    .player-name { font-size: 36px; font-weight: bold; margin-bottom: 10px; }
    .player-score { font-size: 48px; font-weight: bold; color: #FFD700; }
  </style>
</head>
<body>

<div id="game">
  <table id="quizTable"></table>

  <div class="scoreboard">
    <div class="player-box" id="p1-box">
      <div class="player-name" id="p1name"></div>
      <div class="player-score" id="score1">0</div>
    </div>
    <div class="player-box" id="p2-box">
      <div class="player-name" id="p2name"></div>
      <div class="player-score" id="score2">0</div>
    </div>
  </div>
</div>

<script src="questions_rap.js"></script>
<script>
function getMultiplier() {
  return parseInt(localStorage.getItem("multiplier") || "1");
}

function buildTable() {
  const multiplier = getMultiplier();
  const table = document.getElementById("quizTable");
  table.innerHTML = "";

  const cats = Object.values(categories);

  // Kopfzeile
  let header = "<tr>";
  cats.forEach(cat => header += `<th>${cat}</th>`);
  header += "</tr>";
  table.innerHTML += header;

  // 5 Reihen
  const columnColors = [
    ["#993366","#802b52","#661f40","#4d1430","#33091f"],
    ["#cc6600","#b35400","#994400","#803300","#662200"],
    ["#267326","#1f5c1f","#194d19","#133d13","#0d2e0d"],
    ["#254eda","#1f3eb5","#192f8f","#132069","#0d1340"],
    ["#b30000","#990000","#800000","#660000","#4d0000"]
  ];

  for(let r=0; r<5; r++){
    let row = "<tr>";
    cats.forEach((cat,cIdx)=>{
      const key = `${String.fromCharCode(65+cIdx)}-${r+1}`;
      const status = parseInt(localStorage.getItem(`cell-${r}-${cIdx}`)||"0");
      let bg = columnColors[cIdx][r];
      let val = (r+1)*200*multiplier;

      if(status===1) row += `<td style="background:${bg}; border:3px solid yellow; color:white;">${val}</td>`;
      else if(status===2) row += `<td style="background:#222; color:#222;">.</td>`;
      else row += `<td style="background:${bg}; color:white;">${val}</td>`;
    });
    row += "</tr>";
    table.innerHTML += row;
  }

  // Spielername und Score aktualisieren
  document.getElementById("p1name").textContent = localStorage.getItem("player1name") || "Spieler 1";
  document.getElementById("p2name").textContent = localStorage.getItem("player2name") || "Spieler 2";
  document.getElementById("score1").textContent = localStorage.getItem("score1") || 0;
  document.getElementById("score2").textContent = localStorage.getItem("score2") || 0;
}

// Storage-Events
window.addEventListener("storage", e => {
  if(e.key==="score1") document.getElementById("score1").textContent = e.newValue;
  if(e.key==="score2") document.getElementById("score2").textContent = e.newValue;
  if(e.key.startsWith("cell-") || e.key==="multiplier") buildTable();
  if(e.key==="player1name") document.getElementById("p1name").textContent = e.newValue;
  if(e.key==="player2name") document.getElementById("p2name").textContent = e.newValue;
});

window.onload = buildTable;
</script>
</body>
</html>
